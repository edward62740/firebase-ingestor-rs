# Firebase Ingestor

Firebase requires REST API over HTTPS which is too expensive for many power constrained IoT devices.<br>
This project allows for low-power IoT devices to read/write data in a Firebase RTDB instance, by forwarding CoAP messages from the IoT devices.

**IoT Device** <--- *CoAP* ---> **Firebase Ingestor** <--- *REST API* ---> **Firebase**

The ingestor does three things:
- Advertises a service over DNS-SD (RFC 6763) along with its IP address, to be discovered by the IoT device at runtime
- Sets up a CoAP server bound to the abovementioned IP, for the IoT device to post data
- Forwards received CoAP data to Firebase
<br><br>
The executable can be run with the following arguments:
```
firebase-ingestor-rs.exe <dns-sd instance name> <dns-sd service type> <firebase URL> <firebase key>
```

This project was used with IPv6 Thread networks.<br>
However, this program is expected to function on a IPv4 LAN outside of the Thread network, so NAT64 (RFC 6146) may be needed to communicate from IPv6 IoT devices.<br>

Accepted CoAP payloads are in the form /path/../to/field:value,...,field:value for POST/PUT. Hence, it is recommended that there is some network layer encryption.<br>

The CoAP payload is pushed to Firebase and takes on the format below. The actual data is nested inside a parent node "Data", along with other metadata generated by this program.
```
/path/
|
└─── to/
│   │   
│   └───Data
│   |       {field : value}
│   |       {field : value}
│   |        ...
|   └───Ipv4
|   └───Unix timestamp
│   
...
```

For GET, use the form /path/../to/ and returns data as String
